<div class="wrapper wow fadeInDown" style="margin-top: 5rem;" [ngClass]="{'disable': isBusy}">
    <div class="main">
        <div class="container" *ngIf="currentProduct">
            <div class="row">
                <div class="col-6 mt-5 wow slideInLeft">
                    <img src="{{currentProduct.PRODUCT_IMAGE}}" width="90%" >
                </div>
                <div class="col-6 wow slideInRight">
                    <div class="row">
                        <div class="col-12 text-left">
                            <h4 class="text-red">{{currentProduct.PRODUCT_NAME}}</h4>
                        </div>
                        <div class="col-12 mt-2 text-left">
                            <p-rating [ngModel]="currentProduct.PRODUCT_RATING" readonly="true" stars="5" [cancel]="false">
                            </p-rating>
                        </div>
                        <div class="col-12 text-left">
                            Có {{totalQuestion}} lượt bình luận và đánh giá.
                        </div>
                        <div class="col-6 mt-2 text-left">
                            Loại sản phẩm: <span class="txt_pink">{{currentProduct.PRODUCT_TYPE}}</span>
                        </div>
                        <div class="col-6 mt-2 text-left">
                            Thương hiệu: <span class="txt_pink">{{currentProduct.PRODUCT_BRAND}}</span>
                        </div>
                        <div class="col-12 mt-2 text-left  text-red text-title" style="font-size: 20px;">
                             {{currentProduct.PRODUCT_PRICE  | currency : "VND" }} 
                        </div>
                        <div class="col-12 text-left mt-3" *ngIf="!unAuth">
                            <div class="btn-group mb-3">
                                <button class="btn btn-primary btn-round" (click)="updateQuantityPurchased(-1)"
                                    [disabled]="quantityPurchased <=0"><i class="pi pi-minus"></i></button>
                                <p class="ml-3 mr-3 mt-3 mb-2">{{quantityPurchased}}</p>
                                <button class="btn btn-primary btn-round" (click)="updateQuantityPurchased(1)"
                                    [disabled]="currentProduct.PRODUCT_TOTAL <=0"><i class="pi pi-plus"></i></button>
                                <div class="ml-2 mt-3" style="opacity: 0.7;" *ngIf="currentProduct.PRODUCT_TOTAL >0">
                                    (Còn lại: {{currentProduct.PRODUCT_TOTAL}})
                                </div>
                                <div class="ml-2 mt-3" style="opacity: 0.7;color: #E91E63;"
                                    *ngIf="currentProduct.PRODUCT_TOTAL <=0">
                                    (Sản phẩm đã hết hàng)
                                </div>
                            </div>
                        </div>
                        <div class="col-12 " *ngIf="!unAuth">
                            <button class="btn btn-primary btn-round" type="button" [disabled]="quantityPurchased<=0"
                            (click)="addToCart()" >
                                <i class="now-ui-icons ui-2_favourite-28"></i> Thêm vào giỏ hàng
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-12 text-center title-box-new mt-5 cursor-pointer wow slideInDown" >
                    <span class="text-red text-title text-left">THÔNG TIN SẢN PHẨM</span>
                </div>
                <div class="col-12 wow slideInUp">
                    <ul class="list-group">
                        <li class="list-group-item">Xuất xứ: {{currentProduct.PRODUCT_ORIGIN}}</li>
                        <li class="list-group-item">Thương hiệu: {{currentProduct.PRODUCT_BRAND}} </li>
                        <li class="list-group-item">Dung tích: {{currentProduct.PRODUCT_CAPACITY}}</li>
                    <li class="list-group-item">Loại da: {{currentProduct.SKINTYPE_NAME}}</li>
                    </ul>
                </div>
                <div class="col-6 text-center title-box-new mt-5 cursor-pointer " (click)="isShowDetail=true" >
                    <span class=" text-title "  [ngClass]="{'text-red':isShowDetail}">CHI TIẾT SẢN PHẨM</span>
                </div>
                <div class="col-6 text-center title-box-new mt-5 cursor-pointer " (click)="isShowDetail=false">
                    <span class="text-title " [ngClass]="{'text-red':!isShowDetail}">ĐÁNH GIÁ/ HỎI ĐÁP</span>
                </div>
                <div class="col-12 card p-2 wow slideInUp" [innerHTML]="currentProduct.PRODUCT_INFO" *ngIf="isShowDetail" >
                </div>
                <div class="col-12 card wow slideInUp"  *ngIf="!isShowDetail" >
                    <div class="mt-3 mb-3">
                        <div class="row">
                            <div class="col-4 mt-3" style="border-right: 1px solid gray;">
                                <div class="row">
                                    <div class="col-12 text-center">
                                        <b>Đánh giá trung bình</b>
                                    </div>
                                    <div class="col-12 text-center text-red text-title mt-2">
                                        <h4> {{currentProduct.PRODUCT_RATING}}/5 </h4>
                                    </div>
                                    <div class="col-12 text-center mt-2">
                                        <p-rating [ngModel]="currentProduct.PRODUCT_RATING" readonly="true" stars="5"
                                            [cancel]="false"></p-rating>
                                    </div>
                                    <div class="col-12 text-center mt-2">
                                        ( {{totalQuestion}} lượt đánh giá )
                                    </div>
                                </div>
                            </div>
                            <div class="col-8 mt-3">
                                <span>5&nbsp;<i class="pi pi-star" style="color: #E91E63;"></i>
                                    <p-progressBar [value]="50" [style]="{'height': '6px'}" [showValue]="false">
                                    </p-progressBar>
                                </span>
                                <div class="mt-2">4&nbsp;<i class="pi pi-star" style="color: #E91E63;"></i>
                                    <p-progressBar [value]="25" [style]="{'height': '6px'}" [showValue]="false">
                                    </p-progressBar>
                                </div>
                                <div class="mt-2">3&nbsp;<i class="pi pi-star" style="color: #E91E63;"></i>
                                    <p-progressBar [value]="10" [style]="{'height': '6px'}" [showValue]="false">
                                    </p-progressBar>
                                </div>
                                <div class="mt-2">2&nbsp;<i class="pi pi-star" style="color: #E91E63;"></i>
                                    <p-progressBar [value]="10" [style]="{'height': '6px'}" [showValue]="false">
                                    </p-progressBar>
                                </div>
                                <div class="mt-2">1&nbsp;<i class="pi pi-star" style="color: #E91E63;"></i>
                                    <p-progressBar [value]="10" [style]="{'height': '6px'}" [showValue]="false">
                                    </p-progressBar>
                                </div>
                            </div>

                        </div>
                    </div>
                    <hr>
                    <p>NHẬN XÉT VỀ SẢN PHẨM</p>
                    <div *ngIf="!unAuth">
                        <span>Đánh giá sản phẩm này: </span>
                        <p-rating [(ngModel)]="questionInput.PRODUCT_RATING" stars="5" [cancel]="false">
                        </p-rating>
                        <p>Nhận xét: </p>
                        <div class="form-group">
                            <input type="text"  [(ngModel)]="questionInput.QUESTION_CONTENT"  placeholder="Nội dung nhận xét của bạn" class="form-control" 
                            (keydown)="add($event)" />
                            <button class="btn btn-primary btn-round" type="button" [disabled]="!questionInput.QUESTION_CONTENT"
                            (click)="updateProduct()">
                                <i class="now-ui-icons ui-2_favourite-28"></i> Gửi nhận xét
                            </button>
                        </div>
                    </div>
                    <div *ngIf="unAuth" class="text-center">
                        <p>Bạn cần đăng nhập để sử dụng chức năng này!</p>
                        <button class="btn btn-primary btn-round" type="button"
                        (click)="redirectTo('/examples/login','')">
                            <i class="now-ui-icons ui-2_favourite-28"></i> Đăng nhập
                        </button>
                    </div>
                    <hr>
                   <app-question-list [productID]="currentProduct.PRODUCT_ID" [isPaging]="true" [pageSize]="12"></app-question-list>
                </div>

                <div class="col-12 text-center title-box-new mt-5 cursor-pointer" >
                    <span class="text-red text-title text-left">SẢN PHẨM LIÊN QUAN</span>
                </div>
                <div class="col-12 card wow slideInLeft" >
                    <app-product-list [numProductOnRow]="'col-2'" [isAutoSlider]="false" [productType]="currentProduct.PRODUCT_TYPE" [pageSize]="6" [isPaging]="false" ></app-product-list>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="isBusy" class="screen-center">
        <app-spinner></app-spinner>
    </div>
</div>